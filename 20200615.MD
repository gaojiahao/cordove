## cordova android 平台学习笔记

```bash
cordova build android  //默认生成debug版本的apk
```
cordova需要 `npm install -g cordova `全局安装,才能使用cordova命令。
`cordova build -help` 可以查看都哪些参数可以使用。

cordova的功能就是添加项目，然后在项目下添加平台，根据想要的功能添加不同的插件，插件大多是跨平台的。
adroid平台下生成的项目和原生app是一样使用gradle来构建编译，ios平台下只生成平台代码，不能直接编译。

`cordova build android`只编译android平台的apk, 默认是debug版本，也就是可以在手机上调试的版本，体积稍微大些。
`cordova build android --release` 编译release版本，不能在手机上调试。

android编译使用调用/platforms/andorid/cordova/Api.js, 然后调用到/platforms/android/cordova/lib/builders.js,通过builders.js调用ProjectBuilder.js,在projectBuilder.js里调用/platforms/android/gradlew.bat, gradle默认会使用build.gradle,gradle.properties,seting.gradle里的配置。

gradle中一个编译项目会有一个build.gradle配置文件，对build.gradle相对应的参数配置到gradle.properties,与build.gradle同样重要的是settings.gradle,会配置项目与子项目之间的关系。当前android项目之间的关系是根项目是android,两个子项目(也可以看作是项目下的module)是CordovaLib和app,可以在settings.gradle里看到，也可以通过`./gradlew.bat project`(实际上是调用projects这个task)查看。

打开/platforms/android/app下的build.gradle,第20行apply plugin: 'com.android.application',标明编译的最终结果是一个可以独立执行的android应用(apply plugin: 'com.android.library'编译出一个类库)。和maven一样，gradle只是一个框架，依靠各种plugin来执行实现的编译任务。文件156行定义了task cdvBuildDebug,而cdvBuildDebug 默认会调用assembleDebug(应该是在com.andrid.application定义的)，`cordova build android`默认执行task cdvBuildDebug. 在ProjectBuilder.js里的getArgs函数里有定义。

android项目的gradle配置可以参考https://www.cnblogs.com/ut2016-progam/p/5871430.html.